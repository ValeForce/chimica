\usepackage[framemethod=tikz]{mdframed}
\usepackage{tikz}
\usepackage{graphicx}

%AMBIENTE ESERCIZIO

\mdfdefinestyle{esercizio}{ 
  linewidth=0pt,
  linecolor=black,
  backgroundcolor=gray!20,
  outerlinecolor=black,
  bottomline=false,rightline=false,topline=false,
  outerlinewidth=2pt,
  roundcorner=0pt,
  innertopmargin=2pt,
  innerbottommargin=5pt,
  skipabove=\topsep,
  skipbelow=\topsep,
  nobreak=false,
  frametitlefont=\bfseries\sffamily
  %frametitlealignment=\centering,
}

\newcounter{esercizio}[section]
\renewcommand{\theesercizio}{\thesection.\arabic{esercizio}}

\newenvironment{esercizio}[1][]{%
  \refstepcounter{esercizio}% Incrementa il contatore e permette il riferimento
  \ifstrempty{#1}
    {\mdfsetup{frametitle={Esercizio \arabic{section}.\arabic{esercizio}}}}
    {\mdfsetup{frametitle={Esercizio \arabic{section}.\arabic{esercizio} #1}}}
  \begin{mdframed}[style=esercizio]
}{%
  \end{mdframed}
}

%SOLUZIONE

\newenvironment{soluzione}{%
  \begin{center}
    \textbf{\large Svolgimento}
  \end{center}
}{%
}